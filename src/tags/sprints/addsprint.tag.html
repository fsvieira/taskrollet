<add-sprint>
    <div class='add-sprint'>
        <div>
            <button id="tags-sprints"
                class="mdl-button mdl-js-button mdl-button--raised">
                  <div class='tkr-ellipsis tkr-left'>
                      {tagPresentation(selectedTag)}
                  </div>
                  <i class="material-icons">more_vert</i>
            </button>
                
            <ul class="mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect"
                for="tags-sprints"
            >
                <li 
                    class="mdl-menu__item tkr-tags-item" 
                    each={sprintTag in opts.sprints_tags} 
                    onclick={selectTag(sprintTag)}
                    if={sprintTag !== selectedTag}
                >{tagPresentation(sprintTag)}</li>
            </ul>
        </div>
        <input class="mdl-textfield__input js-textfield-required" type="date" onchange={ edit } />

        <button class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored tkr-full-width" onclick={add} disabled={sprintDate.length === 0}>
            Add
        </button>
    </div>
    <script>
        var tag = this;
        var App = require('../../app.js');

        tag.selectedTag = opts.sprints_tags[0];
        tag.sprintDate = "";

        this.edit = function (e) {
            var date = new Date(e.target.value);
            date.setHours(23, 59, 0, 0);

            this.sprintDate = date;
        };

        this.add = function () {
            opts.add_sprint(
                this.selectedTag, 
                this.sprintDate.getTime()
            );
        };

        this.selectTag = function (selectedTag) {
            return function (e) {
                tag.selectedTag = selectedTag;
            };
        };
        
        this.tagPresentation = App.tagPresentation;

        this.on("mount", function () {
            componentHandler.upgradeDom();
        });
        
        this.on('update', function () {
            if (opts.sprints_tags.indexOf(tag.selectedTag) === -1) {
                tag.selectedTag = opts.sprints_tags[0];
            }
        });
    </script>
</add-sprint>